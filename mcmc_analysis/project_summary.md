# Резюме на Проекта: Нелинейна Времева Космология

## 1. Задание на Проекта

Основната цел на този проект е да се разработи и тества нова космологична теория, наречена "Подобрен Линеен Модел" (ПЛМ), която предлага алтернативно обяснение на еволюцията на Вселената без нужда от тъмна енергия и космологична константа (Λ). Теорията се фокусира върху идеята, че енергийната конфигурация на Вселената определя както темпото на времето, така и потенциални временни деформации в линейното разширение на пространството по време на фазови преходи.

Проектът включва:
*   Разработка на математическия модел на ПЛМ.
*   Имплементация на модела в Python.
*   Създаване на Likelihood функции за сравнение на модела с реални астрономически данни (Supernovae Ia, BAO, CMB).
*   Използване на MCMC (Markov Chain Monte Carlo) симулации за напасване на параметрите на модела към данните и сравнение с доминиращия ΛCDM модел.
*   Оптимизация на изчислителното ядро за ускоряване на симулациите.

## 2. Формулировка на Теорията (Подобрен Линеен Модел - ПЛМ)

Теорията се основава на йерархична връзка между пространството, времето и енергията:

### 2.1. Основен Геометричен Закон (Мащабен фактор)
Мащабният фактор `a(t)` описва разширението на пространството. В ПЛМ, той е модифициран линеен закон, включващ функция на деформация `δ(t)`:
$$a(t) = k \cdot t \cdot [1 + \delta(t)]$$
Където:
*   `k` е константа, свързана с константата на Хъбъл `H₀` и възрастта на Вселената `t₀`.
*   `δ(t)` е функция на деформацията, която е приблизително нула при плавна еволюция на Вселената и става ненулева по време на резки енергийни реорганизации (фазови преходи), като рекомбинацията.

### 2.2. Темпо на Времето (Наблюдаемо Време)
Темпото на времето `dτ/dt` описва как физическото време `τ` (възприемано от наблюдател) се различава от абсолютното време `t` на модела. То е функция от общата енергийна плътност `ρ_total(t)`:
$$\frac{d\tau}{dt} = \left[1 + \left(\frac{\rho_{total}(t)}{\rho_{crit}}\right)^\alpha\right]^{-1}$$
Където:
*   `ρ_total(t)` е общата енергийна плътност на Вселената (материя и лъчение).
*   `ρ_crit` е критична плътност, определяща фазовия преход.
*   `α` е показател, контролиращ рязкостта на прехода.

### 2.3. Функция на Деформация `δ(t)` (Принцип на Обратната Връзка)
Функцията на деформация `δ(t)` е пряко свързана с промените в темпото на времето и енергийната плътност. Тя представлява геометрична реакция на пространството на вътрешни "шокове":
$$\delta(t) = \epsilon \cdot \frac{d}{dt}\left(\frac{d\tau}{dt}\right) \cdot \left(\frac{\rho_{total}(t)}{\rho_{crit}}\right)^\beta$$
Където:
*   `ε` е амплитуда, контролираща силата на деформацията.
*   `β` е показател, контролиращ чувствителността към плътност.

### 2.4. Хъбъл Параметър `H(z)`
Хъбъл параметърът `H(z)` (скоростта на разширение) се извежда директно от мащабния фактор `a(t)`:
$$H(t) = \frac{1}{a(t)} \frac{da(t)}{dt}$$
И след това се преобразува в зависимост от червеното отместване `z`.

## 3. Свободни Параметри на ПЛМ
Моделът има 6 свободни параметъра, които ще бъдат напасвани към данните:
*   `H0` (Хъбъл константа днес)
*   `omega_m_h2` (Плътност на материята)
*   `z_crit` (Червено отместване на критичната плътност)
*   `alpha` (Показател на прехода за темпото на времето)
*   `epsilon` (Амплитуда на деформацията δ(t))
*   `beta` (Показател за чувствителност към плътност в δ(t))

## 4. Текущ Етап на Проекта и Тестване

### 4.1. Разработка на Модела
*   **PLM Клас (`mcmc_analysis/models/plm_model.py`):** Моделът е имплементиран, включвайки всички горепосочени формули. Той изчислява разстояния (комовинг, ъглово-диаметрално, светимостно) и Хъбъл параметър, както и звуков хоризонт.
*   **Numba Оптимизация:** Критичните числови методи в `PLM` (като производни и интерполации) са оптимизирани с Numba JIT компилация за значително ускорение. Това включва изнасяне на чистите числови операции в отделни Numba-компилирани помощни функции.

### 4.2. Likelihood Функции
*   **SupernovaeLikelihood (`mcmc_analysis/likelihoods/sn_likelihood.py`):** Имплементирана и тествана. Използва Pantheon+ данни.
*   **BAOLikelihood (`mcmc_analysis/likelihoods/bao_likelihood.py`):** Имплементирана и тествана.
*   **CMBLikelihood (`mcmc_analysis/likelihoods/cmb_likelihood.py`):** Имплементирана и тествана. Включва коректна формула за звуковия хоризонт с отчитане на `dτ/dt` и барионната плътност.

### 4.3. Тестване и Отстраняване на Грешки
*   **Логически Грешки:** Връзката между `a(t)`, `H(z)` и `dτ/dt` беше изяснена, за да се гарантира съгласуваност на теорията.
*   **Numba Грешки:** Първоначалните проблеми с Numba (`non-precise type pyobject`, `NameError: name 'Omega_m' is not defined`, `unsupported NumPy function 'numpy.gradient'`) бяха отстранени чрез:
    *   Предаване на всички необходими параметри изрично на Numba-компилираните помощни функции.
    *   Имплементиране на Numba-съвместима функция за числена производна (`numba_gradient`), заместваща `np.gradient`.
*   **Числова Стабилност:** Кодът е тестван с базови параметри и вече работи без грешки, въпреки че χ² стойностите са високи за неоптимизирани начални параметри.

### 4.4. Следващи Стъпки (MCMC Симулация)
*   **MCMC Настройка:** Скриптът `mcmc_analysis/runners/run_mcmc.py` е създаден и конфигуриран за стартиране на MCMC симулации за ПЛМ и ΛCDM моделите.
*   **Оптимизация на MCMC:** Планирана е и е започната конфигурация за паралелизация на MCMC симулациите, за да се използва пълноценно процесорната мощ.

## 5. Заключение

Проектът е в напреднал етап на разработка. Основният модел е имплементиран и оптимизиран, а Likelihood функциите са готови. След успешното отстраняване на грешките с Numba, системата е готова за провеждане на пълномащабни MCMC симулации, които ще позволят напасване на параметрите и задълбочен сравнителен анализ на ПЛМ с текущите космологични данни.
